<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AdminGo Mini App Fixed</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="//libtl.com/sdk.js" data-zone="10580727" data-sdk="show_10580727"></script>

<style>
  body {
    background-color: #000;
    font-family: 'Segoe UI', Arial, sans-serif;
    margin: 0; padding: 15px; color: white;
    display: flex; flex-direction: column; align-items: center;
  }

  .balance-container {
    background: #0077B6; width: 100%; border-radius: 20px;
    padding: 30px 0; text-align: center; margin-bottom: 20px;
  }
  .balance-amount { font-size: 55px; font-weight: bold; }

  .referral-card {
    background: #121212; border: 1px dashed #444;
    border-radius: 15px; width: 100%; padding: 15px;
    text-align: center; margin-bottom: 20px; box-sizing: border-box;
  }
  .invite-btn {
    background: #F39C12; border: none; padding: 12px;
    border-radius: 30px; color: white; font-weight: bold; width: 85%; cursor: pointer;
  }

  .grid-container {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 12px; width: 100%; margin-bottom: 12px;
  }
  .grid-btn {
    padding: 15px; border-radius: 12px; border: none;
    color: white; font-weight: bold; cursor: pointer;
    display: flex; flex-direction: column; align-items: center; font-size: 14px; gap: 5px;
  }

  .action-btn {
    width: 100%; padding: 15px; border-radius: 12px; border: none;
    color: white; font-weight: bold; margin-bottom: 10px; cursor: pointer;
    display: block; text-align: center;
  }

  .withdraw-btn {
    background-color: #5DADE2; width: 100%; padding: 18px;
    border-radius: 15px; border: none; color: white;
    font-weight: bold; font-size: 18px; margin-top: 10px;
    text-transform: uppercase; cursor: pointer;
  }

  .bg-green { background-color: #2ECC71; }
  .bg-blue { background-color: #3498DB; }
  .bg-purple { background-color: #9B59B6; }
  .bg-yellow { background-color: #F1C40F; color: black; }
  .bg-orange { background-color: #E67E22; }
  .bg-red { background-color: #E74C3C; }
  .bg-teal { background-color: #16A085; }
</style>
</head>
<body>

  <div class="balance-container">
    <div style="font-size: 18px; opacity: 0.9;">Current Balance</div>
    <div id="balance" class="balance-amount">0</div>
  </div>

  <div class="referral-card">
    <div style="color: #FFD700; margin-bottom: 10px;">üéÅ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá ‡¶™‡¶æ‡¶® ‡ßß‡ß¶‡ß¶ ‡¶™‡ßü‡ßá‡¶®‡ßç‡¶ü!</div>
    <button class="invite-btn" onclick="inviteFriend()">üîó Invite Friends & Earn</button>
  </div>

  <button class="action-btn bg-green" onclick="handleAd('Daily', 20)">üéÅ Daily Bonus (+20)</button>

  <div class="grid-container">
    <button class="grid-btn bg-blue" onclick="handleAd('Watch Ad', 10)">üí∞ Watch Ad <span>+10</span></button>
    <button class="grid-btn bg-purple" onclick="handleAd('Spin', 15)">üéØ Spin & Earn <span>+15</span></button>
    <button class="grid-btn bg-yellow" onclick="handleAd('Lucky', 25)">üéÅ Lucky Box <span>+25</span></button>
    <button class="grid-btn bg-orange" onclick="handleAd('Video', 12)">üé¨ Video Quest <span>+12</span></button>
    <button class="grid-btn bg-purple" onclick="handleAd('Challenge', 18)">üèÜ Challenge <span>+18</span></button>
    <button class="grid-btn bg-blue" onclick="handleAd('Game', 22)">üïπÔ∏è Mini Game <span>+22</span></button>
  </div>

  <button class="action-btn bg-red" onclick="showRules()">üìú Rules & Regulations</button>
  
  <button class="action-btn bg-teal" onclick="tg.openLink('https://t.me/yourchannel')">üì¢ Official Channel</button>
  
  <div id="adminArea" style="width: 100%;"></div>

  <button class="withdraw-btn" onclick="requestWithdraw()">üí∞ WITHDRAW MONEY</button>

<script>
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();

const user = tg.initDataUnsafe?.user || { id: 0 };
let balance = 0;

// Rules function fix
function showRules() {
  const rulesText = "‡ßß. Withdraw ‡¶®‡¶ø‡ßü‡¶Æ: ‡ß´‡ß¶‡ß¶‡ß¶ coins ‡¶ï‡¶∞‡ßá‡•§\n" +
                    "‡ß®. Ad/Reward: ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡ßá ‡¶™‡ßü‡ßá‡¶®‡ßç‡¶ü‡•§\n" +
                    "‡ß©. Invite: ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá ‡ßß‡ß¶‡ß¶ ‡¶™‡ßü‡ßá‡¶®‡ßç‡¶ü‡•§\n" +
                    "‡ß™. Mini Games: ‡¶ö‡¶ø‡¶ü‡¶ø‡¶Ç ‡¶ï‡¶∞‡¶æ ‡¶®‡¶ø‡¶∑‡¶ø‡¶¶‡ßç‡¶ß‡•§\n" +
                    "‡ß´. ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§\n" +
                    "‡ß¨. Behavior: ‡¶∏‡ßç‡¶™‡ßç‡¶Ø‡¶æ‡¶Æ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶¨‡ßç‡¶≤‡¶ï‡•§\n" +
                    "‡ß≠. Contact: ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®‡•§";
  
  tg.showPopup({
    title: 'Rules & Regulations',
    message: rulesText,
    buttons: [{type: 'ok', text: '‡¶¨‡ßÅ‡¶ù‡ßá‡¶õ‡¶ø'}]
  });
}

// Admin Check fix
if(user.id === 6311806060) {
  document.getElementById("adminArea").innerHTML = 
    `<button class="action-btn bg-orange" onclick="tg.showAlert('Admin Panel Loading...')">üõ†Ô∏è Admin Dashboard</button>`;
}

async function loadBalance() {
  try {
    const res = await fetch(`https://admingo.onrender.com/getBalance?telegramId=${user.id}`);
    const data = await res.json();
    balance = data.balance || 0;
    document.getElementById("balance").innerText = balance;
  } catch (e) { document.getElementById("balance").innerText = "0"; }
}

async function addCoins(points) {
  try {
    await fetch('https://admingo.onrender.com/addCoins', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ telegramId: user.id, amount: points })
    });
    balance += points;
    document.getElementById("balance").innerText = balance;
    tg.HapticFeedback.notificationOccurred('success');
  } catch (e) {}
}

function handleAd(name, points) {
  if (typeof show_10580727 === "function") {
    show_10580727();
    setTimeout(() => addCoins(points), 2000);
  } else { addCoins(points); }
}

function inviteFriend() {
  const link = `https://t.me/Tetris1earnbot?start=${user.id}`;
  tg.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=Join and Earn!`);
}

function requestWithdraw() {
  if(balance < 5000) tg.showAlert("‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡ß´‡ß¶‡ß¶‡ß¶ ‡¶™‡ßü‡ßá‡¶®‡ßç‡¶ü ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá!");
  else tg.showAlert("‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶ü ‡¶∏‡¶´‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
}

loadBalance();
</script>
</body>
  </html>
  
