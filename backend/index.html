<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AdminGo Mini App HD</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="//libtl.com/sdk.js" data-zone="10580727" data-sdk="show_10580727"></script>

<style>
body {
  font-family: 'Arial', sans-serif;
  margin: 0;
  padding: 10px;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(135deg, #f6d365, #fda085);
  background-size: 400% 400%;
  animation: gradientBG 20s ease infinite;
}

@keyframes gradientBG {
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

.card {
  background: #1b1b1b;
  border-radius: 20px;
  padding: 20px;
  width: 100%;
  max-width: 420px;
  box-shadow: 0 6px 25px rgba(0,0,0,0.3);
  display: flex;
  flex-direction: column;
  gap: 20px;
  text-align: center;
  transform: translateY(0);
  animation: floatCard 6s ease-in-out infinite;
}

@keyframes floatCard {
  0%,100%{ transform: translateY(0);}
  50%{ transform: translateY(-6px);}
}

h2 { margin-bottom: 5px; font-weight: bold; color:#fff; }

.balance-card {
  background: linear-gradient(45deg, #FFD700, #FF8C00);
  color: white;
  padding: 25px;
  border-radius: 20px;
  font-size: 22px;
  font-weight: bold;
  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
}

#buttons {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.btn, .single-btn {
  border: none;
  border-radius: 15px;
  padding: 18px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn { font-size:16px; color:white; }
.single-btn { font-size:18px; width:100%; max-width:220px; color:white; }

.btn:hover, .single-btn:hover { transform: scale(1.08) translateY(-2px); box-shadow: 0 8px 18px rgba(0,0,0,0.35); }

/* Button Colors */
.watch-ad{ background:#FF6B6B; } .spin-earn{ background:#6BCB77; } 
.daily-bonus{ background:#4D96FF; } .lucky-box{ background:#FFD93D; color:#333;} 
.video-quest{ background:#FF6EC7; } .challenge-reward{ background:#FF9F1C; }
.mini-game{ background:#845EC2; } .invite{ background:#00C9A7; } 
.withdraw{ background:#FF595E; } .contact{ background:#FFB547; color:#333; } 
.rules{ background:#333; } .admin{ background:#333; }

/* Points Label */
.points{ display:block; font-size:14px; margin-top:5px; opacity:0.8; }

/* Modal */
.modal {
  display:none;
  position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.5);
  backdrop-filter: blur(5px);
  justify-content:center; align-items:center;
  z-index:1000; opacity:0; transition: opacity 0.25s ease;
}
.modal.show{ opacity:1; }
.modal-content {
  background:#fff; padding:25px 20px; border-radius:20px;
  max-width:400px; width:90%; max-height:80%; overflow-y:auto;
  text-align:center; position:relative;
  box-shadow:0 8px 25px rgba(0,0,0,0.3);
  transform:scale(0.95);
  transition: all 0.25s ease;
}
.modal.show .modal-content{ transform:scale(1);}
.modal-close{
  position:absolute; top:10px; right:15px; cursor:pointer; font-weight:bold; font-size:22px; color:#333;
}
.modal-close:hover{ color:#FF595E; }
.modal-content h3{ margin-bottom:15px; }
.modal-content p{ margin-bottom:15px; }
.modal-content button{
  width:auto; padding:12px 18px; margin:5px; border-radius:12px; font-weight:bold; cursor:pointer; transition:all 0.2s ease;
}
.modal-content button:hover{ transform: scale(1.08) translateY(-2px); }
</style>
</head>
<body>

<div class="card">
  <h2 id="welcomeMsg">Loading...</h2>
  <div id="balance" class="balance-card"></div>
  <div id="buttons"></div>
  <div id="singleButtons"></div>
</div>

<!-- Rules Modal -->
<div id="rulesModal" class="modal">
  <div class="modal-content">
    <span class="modal-close" id="closeRules">&times;</span>
    <div id="rulesContent"></div>
  </div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();
let balance=0;
const user=tg.initDataUnsafe?.user;

// -------------------- Load Balance --------------------
async function loadBalance(){
  try{
    const res=await fetch(`https://admingo.onrender.com/getBalance?telegramId=${user.id}`);
    const data=await res.json();
    balance=data.balance||0;
    document.getElementById("balance").innerText=`Balance: ${balance} coins`;
  }catch(e){ console.log("Error loading balance:",e);}
}

// -------------------- Add Coins --------------------
async function addCoins(points){
  try{
    await fetch('https://admingo.onrender.com/addCoins',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({telegramId:user.id,amount:points})
    });
    balance+=points;
    document.getElementById("balance").innerText=`Balance: ${balance} coins`;
  }catch(e){ console.log("Error adding coins:",e);}
}

// -------------------- Monetag Ad --------------------
function showMonetagAd(name,points){ 
  if(typeof show_10580727==="function") show_10580727(); 
  // Points will be added AFTER ad
  setTimeout(()=>addCoins(points), 3000); 
}

// -------------------- Invite Friend --------------------
function inviteFriend(){ 
  tg.openLink(`https://t.me/Tetris1earnbot?start=${user.id}`); 
  alert("+50 Coins for successful referral!"); 
}

// -------------------- Modal --------------------
function openModal(modal){ modal.style.display="flex"; setTimeout(()=>modal.classList.add("show"),10);}
function closeModal(modal){ modal.classList.remove("show"); setTimeout(()=>modal.style.display="none",250); }

// -------------------- Rules --------------------
const rulesContent=`<h3>AdminGo Mini App Rules & Regulations</h3>
<ol>
<li><b>Withdraw ‡¶®‡¶ø‡ßü‡¶Æ:</b> ‡ß´‡ß¶‡ß¶‡ß¶ coins ‡¶ï‡¶∞‡ßá‡•§ ‡¶®‡¶ó‡¶¶, ‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶¨‡¶æ ‡¶∞‡¶ï‡ßá‡¶ü ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡•§</li>
<li><b>Ad/Reward Usage:</b> Watch Ad, Spin & Earn, Lucky Box, Video Quest ‡¶•‡ßá‡¶ï‡ßá ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü‡•§</li>
<li><b>Invite Friend:</b> ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá +50 Coins‡•§</li>
<li><b>Mini Games / Challenges:</b> Cheats ‡¶¨‡¶æ ‡¶Ö‡¶®‡ßç‡¶Ø‡ßá‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∑‡¶ø‡¶¶‡ßç‡¶ß‡•§</li>
<li><b>Coins ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏:</b> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶¨‡¶æ Withdraw‡•§</li>
<li><b>General Behavior:</b> Spam ‡¶¨‡¶æ Malicious behavior ‡¶ï‡¶∞‡¶≤‡ßá block ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§</li>
<li><b>Contact / Complaint:</b> Contact Us ‡¶¨‡¶æ‡¶ü‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ Admin Panel ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ Admin‡•§</li>
</ol>`;
const rulesModal=document.getElementById("rulesModal");
const closeRules=document.getElementById("closeRules");
function showRules(){ document.getElementById("rulesContent").innerHTML=rulesContent; openModal(rulesModal);}
closeRules.onclick=()=>closeModal(rulesModal);

// -------------------- UI Setup --------------------
if(!user){ document.body.innerHTML="<h2>User data not found. Open from Telegram.</h2>"; }
else{
  document.getElementById("welcomeMsg").innerText=`Welcome ${user.first_name}`;
  loadBalance();

  const buttonsData=[
    {emoji:"üí∞",name:"Watch Ad",points:10,cls:"watch-ad"},
    {emoji:"üéØ",name:"Spin & Earn",points:15,cls:"spin-earn"},
    {emoji:"üì¶",name:"Daily Bonus",points:20,cls:"daily-bonus"},
    {emoji:"üéÅ",name:"Lucky Box",points:25,cls:"lucky-box"},
    {emoji:"üé¨",name:"Video Quest",points:12,cls:"video-quest"},
    {emoji:"üèÜ",name:"Challenge Reward",points:18,cls:"challenge-reward"},
    {emoji:"üïπÔ∏è",name:"Mini Game Bonus",points:22,cls:"mini-game"}
  ];

  const buttonsDiv=document.getElementById("buttons");
  buttonsData.forEach(btn=>{
    const b=document.createElement("button");
    b.className=`btn ${btn.cls}`;
    b.innerHTML=`${btn.emoji} ${btn.name}<span class="points">+${btn.points} coins</span>`;
    b.onclick=()=>showMonetagAd(btn.name,btn.points);
    buttonsDiv.appendChild(b);
  });

  const singleBtns=[
    {name:"Invite Friend (+50 coins)",cls:"invite",action:inviteFriend},
    {name:"Withdraw",cls:"withdraw",action:()=>alert("Withdraw flow")},
    {name:"Rules / Regulation",cls:"rules",action:showRules},
    {name:"Contact Us",cls:"contact",action:()=>alert("Contact / Complaint")}
  ];

  const isAdmin=user.id===6311806060;
  if(isAdmin) singleBtns.push({name:"Admin Panel",cls:"admin",action:()=>alert("Admin Panel")});

  const singleButtonsDiv=document.getElementById("singleButtons");
  singleBtns.forEach(btn=>{
    const b=document.createElement("button");
    b.className=`single-btn ${btn.cls}`;
    b.innerText=btn.name;
    b.onclick=btn.action;
    singleButtonsDiv.appendChild(b);
  });
}
</script>
</body>
  </html>
