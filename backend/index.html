<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admingo</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<script src="https://libtl.com/sdk.js" data-zone="10580727" data-sdk="show_10580727"></script>

<style>
body{ margin:0; background:#0b0b0b; font-family:Arial, sans-serif; color:white; -webkit-user-select: none; }
.container{padding:15px}
.balance{ background:#0277bd; padding:25px; border-radius:15px; text-align:center; font-size:28px; margin-bottom: 15px;}
.grid{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
.btn{ padding:18px; border-radius:12px; text-align:center; font-weight:bold; cursor:pointer; active { opacity: 0.8; } }
.green{background:#2ecc71} .blue{background:#3498db} .purple{background:#9b59b6}
.orange{background:#e67e22} .yellow{background:#f1c40f;color:black} .red{background:#e74c3c}
.full{grid-column:1/3}
</style>
</head>

<body>
<div class="container">
  <div class="balance">
    Current Balance<br>
    <span id="balance">0</span>
  </div>

  <div class="btn orange full" onclick="invite()">ЁЯФЧ Invite Friends & Earn</div>
  <div class="btn green full" onclick="daily()">ЁЯОБ Daily Bonus (+20)</div>

  <div class="grid">
    <div class="btn blue" onclick="earn(10)">ЁЯТ░ Watch Ad +10</div>
    <div class="btn purple" onclick="earn(15)">ЁЯОп Spin & Earn +15</div>
    <div class="btn yellow" onclick="earn(25)">ЁЯОБ Lucky Box +25</div>
    <div class="btn orange" onclick="earn(12)">ЁЯОм Video Quest +12</div>
    <div class="btn purple" onclick="earn(18)">ЁЯПЖ Challenge +18</div>
    <div class="btn blue" onclick="earn(22)">ЁЯОо Mini Game +22</div>
    <div class="btn red full" onclick="withdrawPrompt()">ЁЯТ╕ Withdraw</div>
    <div class="btn green full" onclick="adminPanel()">ЁЯЫа Admin Panel</div>
    <div class="btn yellow full" onclick="rules()">ЁЯУЬ Rules & Regulations</div>
  </div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();

// ржЗржЙржЬрж╛рж░ ржЖржЗржбрж┐ ржЪрзЗржХ
const user = tg.initDataUnsafe.user || { id: 0 };
const API = "https://admingo.onrender.com";

/* ========== ржмрзНржпрж╛рж▓рзЗржирзНрж╕ рж▓рзЛржб ========== */
async function loadBalance(){
  try {
    const r = await fetch(`${API}/getBalance?telegramId=${user.id}`);
    const d = await r.json();
    document.getElementById("balance").innerText = d.balance || 0;
  } catch(e) { console.error("Balance Load Fail"); }
}

/* ========== ржХрзЯрзЗржи ржЖрзЯ (Ad Logic) ========== */
async function earn(points) {
  // рзз. ржЪрзЗржХ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ Monetag рж▓рзЛржб рж╣рзЯрзЗржЫрзЗ ржХрж┐ ржирж╛
  if (typeof show_10580727 === "function") {
    show_10580727().then(() => {
      // ржЕрзНржпрж╛ржб ржжрзЗржЦрж╛ рж╢рзЗрж╖ рж╣рж▓рзЗ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржХрзЯрзЗржи ржпрж╛ржмрзЗ
      addPoints(points);
    }).catch(() => {
      tg.showAlert("ржЕрзНржпрж╛ржб рж▓рзЛржб рж╣рзЯржирж┐, ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред");
    });
  } else {
    // ржпржжрж┐ рж╕рзНржХрзНрж░рж┐ржкрзНржЯ рж▓рзЛржб ржирж╛ рж╣рзЯ рждржмрзЗ рж╕рж░рж╛рж╕рж░рж┐ ржХрзЯрзЗржи ржжрзЗржУрзЯрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ (ржЯрзЗрж╕рзНржЯрж┐ржВ ржПрж░ ржЬржирзНржп)
    tg.showAlert("ржЕрзНржпрж╛ржб рж╕рзНржХрзНрж░рж┐ржкрзНржЯ ржкрж╛ржУрзЯрж╛ ржпрж╛ржЪрзНржЫрзЗ ржирж╛, ржжрзЯрж╛ ржХрж░рзЗ ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзБржиред");
  }
}

/* ========== ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржХрзЯрзЗржи ржЕрзНржпрж╛ржб ========== */
async function addPoints(points) {
  try {
    const response = await fetch(`${API}/addCoins`, {
      method: "POST",
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({telegramId: user.id, amount: points})
    });
    const data = await response.json();
    if(data.success) {
      loadBalance();
      tg.showAlert(`ржЕржнрж┐ржиржирзНржжржи! +${points} ржХрзЯрзЗржи ржкрзЗрзЯрзЗржЫрзЗржиред`);
    }
  } catch(e) { console.error("Add Points Fail"); }
}

/* ========== ржбрзЗржЗрж▓рж┐ ржмрзЛржирж╛рж╕ ========== */
async function daily(){
  const r = await fetch(`${API}/dailyBonus`, {
    method: "POST",
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({telegramId: user.id})
  });
  const d = await r.json();
  if(d.success) {
    tg.showAlert("ржбрзЗржЗрж▓рж┐ ржмрзЛржирж╛рж╕ ржпрзЛржЧ рж╣рзЯрзЗржЫрзЗ!");
    loadBalance();
  } else {
    tg.showAlert(d.message || "ржЖржЬржХрзЗрж░ ржмрзЛржирж╛рж╕ ржирзЗржУрзЯрж╛ рж╣рзЯрзЗ ржЧрзЗржЫрзЗред");
  }
}

/* ========== ржЗржиржнрж╛ржЗржЯ рж▓рж┐ржЩрзНржХ ========== */
function invite(){
  const link = `https://t.me/Tetris1earnbot?start=ref_${user.id}`;
  tg.openTelegramLink(link);
}

/* ========== ржЙржЗржержбрзНрж░ ========== */
function withdrawPrompt(){
  const amount = prompt("ржХржд ржХрзЯрзЗржи ржЙржЗржержбрзНрж░ ржХрж░ржмрзЗржи?");
  const method = prompt("ржкрзЗржорзЗржирзНржЯ ржорзЗржержб (Bkash/Nagad):");
  const number = prompt("ржорзЛржмрж╛ржЗрж▓ ржиржорзНржмрж░ ржжрж┐ржи:");
  
  if(!amount || !method || !number) return;

  fetch(`${API}/withdraw`, {
    method: "POST",
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      telegramId: user.id,
      amount: Number(amount),
      method,
      number
    })
  }).then(r => r.json()).then(d => {
    if(d.success) tg.showAlert("ржЙржЗржержбрзНрж░ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ рж╕ржлрж▓ рж╣рзЯрзЗржЫрзЗ!");
    else tg.showAlert(d.message || "ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржХржо ржЖржЫрзЗ!");
    loadBalance();
  });
}

// Rules & Admin (рж╕ржВржХрзНрж╖рж┐ржкрзНржд)
function rules(){ tg.showAlert("рзз. ржкрзНрж░рждрж┐ржжрж┐ржи ржмрзЛржирж╛рж╕ ржирж┐ржиред\nрзи. ржЕрзНржпрж╛ржб ржжрзЗржЦрзЗ ржЖрзЯ ржХрж░рзБржиред"); }
async function adminPanel(){ tg.showAlert("Admin Panel is under construction."); }

// Initial Load
loadBalance();
</script>
</body>
</html>
