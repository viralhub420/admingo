<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AdminGo Mini App</title>

<!-- Telegram Web App SDK -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- Monetag SDK -->
<script src='//libtl.com/sdk.js' data-zone='10580727' data-sdk='show_10580727'></script>

<style>
body {
  font-family: 'Arial', sans-serif;
  margin: 0;
  padding: 10px;
  background: linear-gradient(135deg, #74ebd5, #ACB6E5);
  color: #333;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  box-sizing: border-box;
}

.card {
  background: #fff;
  border-radius: 20px;
  padding: 20px;
  width: 100%;
  max-width: 420px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.25);
  display: flex;
  flex-direction: column;
  gap: 20px;
  text-align: center;
}

/* Header */
h2 { margin-bottom: 5px; font-weight: bold; }

/* Balance Card */
.balance-card {
  background: linear-gradient(45deg, #FFD700, #FF8C00);
  color: white;
  padding: 25px;
  border-radius: 20px;
  font-size: 22px;
  font-weight: bold;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
}

/* Buttons Grid */
#buttons {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
}

/* Earning Buttons */
.btn {
  border: none;
  color: white;
  padding: 18px 20px;
  border-radius: 15px;
  cursor: pointer;
  font-weight: bold;
  font-size: 16px;
  transition: transform 0.2s, box-shadow 0.2s;
}
.btn:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 12px rgba(0,0,0,0.3);
}

/* Single Buttons */
#singleButtons {
  display: flex;
  flex-direction: column;
  gap: 15px;
  align-items: center;
}
.single-btn {
  padding: 18px;
  border-radius: 20px;
  font-size: 18px;
  font-weight: bold;
  cursor: pointer;
  width: 100%;
  max-width: 220px;
  transition: transform 0.2s;
}
.single-btn:hover { transform: scale(1.05); }

/* Colors */
.watch-ad { background: #FF6B6B; }
.spin-earn { background: #6BCB77; }
.daily-bonus { background: #4D96FF; }
.lucky-box { background: #FFD93D; color:#333; }
.video-quest { background: #FF6EC7; }
.challenge-reward { background: #FF9F1C; }
.mini-game { background: #845EC2; }

.invite { background: #00C9A7; color:white; }
.withdraw { background: #FF595E; color:white; font-size:18px; }
.contact { background: #FFB547; color: #333; }
.admin { background: #333; color:white; }

.points { display: block; font-size: 14px; margin-top: 5px; opacity: 0.8; }
</style>
</head>
<body>

<div class="card">
  <h2 id="welcomeMsg">Loading...</h2>
  <div id="balance" class="balance-card"></div>
  <div id="buttons"></div>
  <div id="singleButtons"></div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

let balance = 0;
const user = tg.initDataUnsafe?.user;

// -------------------- Backend Balance --------------------
async function loadBalance() {
  try {
    const res = await fetch(`https://admingo.onrender.com/getBalance?telegramId=${user.id}`);
    const data = await res.json();
    balance = data.balance || 0;
    document.getElementById("balance").innerText = `Balance: ${balance} coins`;
  } catch(e) { console.log("Error loading balance:", e); }
}

async function addCoins(points) {
  try {
    await fetch('https://admingo.onrender.com/addCoins', {
      method: 'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ telegramId: user.id, amount: points })
    });
    balance += points;
    document.getElementById("balance").innerText = `Balance: ${balance} coins`;
  } catch(e){ console.log("Error adding coins:", e); }
}

// -------------------- Monetag Ad Show --------------------
function showMonetagAd(buttonName, points) {
  if(typeof show_10580727 === "function") show_10580727(); // Monetag ad show
  addCoins(points);
}

// -------------------- UI Setup --------------------
if(!user){
  document.body.innerHTML = "<h2>User data not found. Open from Telegram.</h2>";
} else {
  document.getElementById("welcomeMsg").innerText = `Welcome ${user.first_name}`;
  loadBalance();

  // Earning Buttons
  const buttonsData = [
    { emoji: "ðŸ’°", name: "Watch Ad", points: 10, cls:"watch-ad" },
    { emoji: "ðŸŽ¯", name: "Spin & Earn", points: 15, cls:"spin-earn" },
    { emoji: "ðŸ“¦", name: "Daily Bonus", points: 20, cls:"daily-bonus" },
    { emoji: "ðŸŽ", name: "Lucky Box", points: 25, cls:"lucky-box" },
    { emoji: "ðŸŽ¬", name: "Video Quest", points: 12, cls:"video-quest" },
    { emoji: "ðŸ†", name: "Challenge Reward", points: 18, cls:"challenge-reward" },
    { emoji: "ðŸ•¹ï¸", name: "Mini Game Bonus", points: 22, cls:"mini-game" }
  ];

  const buttonsDiv = document.getElementById("buttons");
  buttonsData.forEach(btn => {
    const button = document.createElement("button");
    button.className = `btn ${btn.cls}`;
    button.innerHTML = `${btn.emoji} ${btn.name}<span class="points">+${btn.points} coins</span>`;
    button.onclick = () => showMonetagAd(btn.name, btn.points);
    buttonsDiv.appendChild(button);
  });

  // Single Buttons
  const singleBtns = [
    { name: "Invite Friend (+50 coins)", cls: "invite", action: ()=>alert("Invite friend flow") },
    { name: "Withdraw", cls: "withdraw", action: ()=>alert("Withdraw flow") },
    { name: "Contact Us", cls: "contact", action: ()=>alert("Contact / Complaint") }
  ];
  const isAdmin = user.id === 6311806060; // <-- replace with your Telegram ID
  if(isAdmin) singleBtns.push({ name: "Admin Panel", cls: "admin", action: ()=>alert("Admin Panel") });

  const singleButtonsDiv = document.getElementById("singleButtons");
  singleBtns.forEach(btn=>{
    const b = document.createElement("button");
    b.className = `single-btn ${btn.cls}`;
    b.innerText = btn.name;
    b.onclick = btn.action;
    singleButtonsDiv.appendChild(b);
  });
}
</script>

</body>
</html>
